## 核心设计理念

### 数据结构
```json
{
  "delivery_strategy_config": {
    "version": "1.0.0",
    "update_time": "2025-08-01T10:00:00Z",
    "default_config": {
      "enabled": true,
      "strategy_type": "price_priority",
      "fallback_enabled": true,
      "max_retry_times": 3,
      "timeout_seconds": 30,
      "platforms": {
        "uu_delivery": {
          "platform_id": "uu",
          "platform_name": "UU跑腿",
          "enabled": true,
          "priority": 1,
          "weight": 100,
          "pricing": {
            "base_price": 5.0,
            "distance_price_per_km": 2.0,
            "weight_price_per_kg": 1.0,
            "time_multiplier": {
              "peak_hours": 1.5,
              "normal_hours": 1.0,
              "off_peak_hours": 0.8
            }
          },
          "service_config": {
            "max_distance_km": 20,
            "max_weight_kg": 30,
            "estimated_delivery_time_minutes": 45,
            "support_cod": true,
            "support_fragile": true,
            "support_cold_chain": false
          },
          "api_config": {
            "endpoint": "https://api.uu.com/delivery",
            "timeout_ms": 5000,
            "retry_times": 2,
            "auth": {
              "type": "api_key",
              "key_field": "X-API-Key"
            }
          }
        },
        "dada_delivery": {
          "platform_id": "dada",
          "platform_name": "达达快送",
          "enabled": true,
          "priority": 2,
          "weight": 90,
          "pricing": {
            "base_price": 4.5,
            "distance_price_per_km": 1.8,
            "weight_price_per_kg": 0.8,
            "time_multiplier": {
              "peak_hours": 1.4,
              "normal_hours": 1.0,
              "off_peak_hours": 0.9
            }
          },
          "service_config": {
            "max_distance_km": 15,
            "max_weight_kg": 25,
            "estimated_delivery_time_minutes": 40,
            "support_cod": true,
            "support_fragile": false,
            "support_cold_chain": true
          },
          "api_config": {
            "endpoint": "https://api.dada.com/delivery",
            "timeout_ms": 4000,
            "retry_times": 3,
            "auth": {
              "type": "oauth2",
              "token_endpoint": "https://api.dada.com/oauth/token"
            }
          }
        },
        "sf_delivery": {
          "platform_id": "sf",
          "platform_name": "顺丰同城",
          "enabled": true,
          "priority": 3,
          "weight": 80,
          "pricing": {
            "base_price": 6.0,
            "distance_price_per_km": 2.5,
            "weight_price_per_kg": 1.2,
            "time_multiplier": {
              "peak_hours": 1.6,
              "normal_hours": 1.0,
              "off_peak_hours": 0.7
            }
          },
          "service_config": {
            "max_distance_km": 30,
            "max_weight_kg": 50,
            "estimated_delivery_time_minutes": 35,
            "support_cod": true,
            "support_fragile": true,
            "support_cold_chain": true
          },
          "api_config": {
            "endpoint": "https://api.sf-express.com/delivery",
            "timeout_ms": 6000,
            "retry_times": 2,
            "auth": {
              "type": "signature",
              "secret_key_field": "secret"
            }
          }
        }
      },
      "strategy_rules": {
        "price_priority": {
          "enabled": true,
          "weight": 0.6,
          "consider_service_fee": true
        },
        "time_priority": {
          "enabled": true,
          "weight": 0.3,
          "max_acceptable_delay_minutes": 15
        },
        "reliability_priority": {
          "enabled": true,
          "weight": 0.1,
          "min_success_rate": 0.95
        }
      },
      "business_rules": {
        "peak_hours": ["11:00-13:00", "17:00-20:00"],
        "blacklist_check": true,
        "distance_limit_km": 25,
        "weight_limit_kg": 40,
        "cod_limit_amount": 5000.0
      }
    },
    "city_specific_configs": {
      "beijing": {
        "city_code": "110000",
        "city_name": "北京市",
        "enabled": true,
        "strategy_type": "time_priority",
        "platforms": {
          "uu_delivery": {
            "enabled": true,
            "priority": 2,
            "weight": 95,
            "pricing": {
              "base_price": 6.0,
              "distance_price_per_km": 2.5,
              "weight_price_per_kg": 1.2,
              "time_multiplier": {
                "peak_hours": 1.8,
                "normal_hours": 1.2,
                "off_peak_hours": 1.0
              }
            },
            "service_config": {
              "max_distance_km": 25,
              "estimated_delivery_time_minutes": 40
            }
          },
          "dada_delivery": {
            "enabled": true,
            "priority": 1,
            "weight": 100,
            "pricing": {
              "base_price": 5.5,
              "distance_price_per_km": 2.2,
              "weight_price_per_kg": 1.0
            }
          },
          "sf_delivery": {
            "enabled": false,
            "reason": "服务暂不可用"
          }
        },
        "business_rules": {
          "peak_hours": ["11:00-14:00", "16:30-20:30"],
          "distance_limit_km": 30,
          "special_zones": [
            {
              "zone_name": "CBD区域",
              "coordinates": [
                [116.45, 39.92],
                [116.48, 39.94]
              ],
              "additional_fee": 3.0,
              "priority_platforms": ["dada_delivery", "uu_delivery"]
            }
          ]
        }
      },
      "shanghai": {
        "city_code": "310000",
        "city_name": "上海市",
        "enabled": true,
        "strategy_type": "hybrid",
        "platforms": {
          "uu_delivery": {
            "enabled": true,
            "priority": 1,
            "pricing": {
              "base_price": 5.5,
              "distance_price_per_km": 2.2
            }
          },
          "dada_delivery": {
            "enabled": true,
            "priority": 2,
            "service_config": {
              "support_cold_chain": true,
              "estimated_delivery_time_minutes": 35
            }
          },
          "meituan_delivery": {
            "platform_id": "meituan",
            "platform_name": "美团配送",
            "enabled": true,
            "priority": 3,
            "weight": 85,
            "pricing": {
              "base_price": 4.8,
              "distance_price_per_km": 1.9,
              "weight_price_per_kg": 0.9
            },
            "service_config": {
              "max_distance_km": 18,
              "max_weight_kg": 28,
              "estimated_delivery_time_minutes": 38
            }
          }
        },
        "business_rules": {
          "weather_adjustment": true,
          "rainy_day_multiplier": 1.3,
          "special_zones": [
            {
              "zone_name": "浦东新区",
              "additional_fee": 2.0,
              "preferred_platform": "uu_delivery"
            }
          ]
        }
      },
      "shenzhen": {
        "city_code": "440300",
        "city_name": "深圳市",
        "enabled": true,
        "inherit_default": true,
        "overrides": {
          "platforms": {
            "uu_delivery": {
              "pricing": {
                "base_price": 5.2,
                "distance_price_per_km": 2.0
              }
            }
          },
          "business_rules": {
            "distance_limit_km": 22
          }
        }
      }
    },
    "global_settings": {
      "monitoring": {
        "success_rate_threshold": 0.90,
        "response_time_threshold_ms": 10000,
        "alert_channels": ["email", "sms", "webhook"]
      },
      "fallback_strategy": {
        "enabled": true,
        "fallback_platforms": ["uu_delivery", "dada_delivery"],
        "max_fallback_attempts": 2
      },
      "cache_settings": {
        "quote_cache_ttl_seconds": 300,
        "platform_status_cache_ttl_seconds": 60
      },
      "rate_limiting": {
        "requests_per_minute": 1000,
        "requests_per_platform_per_minute": 300
      }
    }
  }
}
```

### 1. 分层配置架构

- default_config: 全局默认配置
- city_specific_configs: 城市特殊配置（可覆盖默认配置）
- global_settings: 全局系统设置

### 2. 多平台支持

- 支持UU跑腿、达达快送、顺丰同城等主流配送平台
- 每个平台包含定价、服务能力、API配置等完整信息

### 3. 灵活的策略配置

支持价格优先、时效优先、可靠性优先等多种策略
可配置权重和组合策略

## 关键功能特性
### 城市特殊配置支持：

- 北京：时效优先策略，特殊CBD区域配置
- 上海：混合策略，支持美团配送，天气调整
- 深圳：继承默认配置但有局部覆盖

### 报价和服务配置：

- 基础价格、距离费用、重量费用
- 时段价格倍数（高峰期、平峰期、低峰期）
- 服务能力限制（最大距离、重量、时效等）

### 业务规则：

- 高峰时段定义
- 距离和重量限制
- 货到付款限额
- 特殊区域配置

### 系统保障：

- 降级策略和重试机制
- 监控告警配置
- 缓存和限流设置

这个数据结构设计既保证了灵活性，又确保了系统的可扩展性和维护性。您可以根据具体业务需求调整配置参数。